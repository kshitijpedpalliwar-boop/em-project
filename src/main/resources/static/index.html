<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Employee REST Client</title>
  <style>
    body{font-family:Arial,Helvetica,sans-serif;max-width:900px;margin:24px auto;padding:0 16px}
    .container{background:#fff;padding:18px;border-radius:8px;box-shadow:0 6px 18px rgba(0,0,0,.06)}
    .form-row{display:flex;gap:12px;align-items:center;margin-bottom:10px}
    label{width:80px;font-weight:600}
    input{padding:8px;border:1px solid #ccc;border-radius:4px}
    button{padding:8px 12px;border-radius:6px;border:0;cursor:pointer}
    .btn-save{background:#198754;color:#fff}
    .btn-cancel{background:#6c757d;color:#fff}
    table{width:100%;border-collapse:collapse;margin-top:18px}
    th,td{border:1px solid #e6e6e6;padding:8px;text-align:left}
    th{background:#f8f9fa}
    .btn-edit{background:#ffc107;border-radius:4px;padding:6px 8px}
    .btn-delete{background:#dc3545;color:#fff;border-radius:4px;padding:6px 8px}
    #msg{display:none;padding:8px;border-radius:6px;margin-bottom:12px}
    #msg.success{background:#d4edda;color:#155724;border:1px solid #c3e6cb}
    #msg.error{background:#f8d7da;color:#721c24;border:1px solid #f5c6cb}
  </style>
</head>
<body>
  <div class="container">
    <h1>Employee Management</h1>
    <div id="msg"></div>

    <form id="employeeForm">
      <input type="hidden" id="employeeId" />
      <div class="form-row">
        <label for="name">Name</label>
        <input id="name" name="name" required />
      </div>
      <div class="form-row">
        <label for="email">Email</label>
        <input id="email" name="email" type="email" required />
      </div>
      <div class="form-row">
        <label for="phone">Phone</label>
        <input id="phone" name="phone" required />
      </div>
      <div style="display:flex;gap:10px;align-items:center">
        <button type="submit" class="btn-save">Save</button>
        <button type="button" id="cancelBtn" class="btn-cancel" style="display:none">Cancel</button>
      </div>
    </form>

    <h2>Employees</h2>
    <table>
      <thead>
        <tr><th>Name</th><th>Email</th><th>Phone</th><th>Actions</th></tr>
      </thead>
      <tbody id="employeeList"><tr><td colspan="4" style="color:#888">Loadingâ€¦</td></tr></tbody>
    </table>
  </div>

  <script>
    const API = '/api/v1/employees';
    const msg = id => { const m = document.getElementById('msg'); m.textContent = id || ''; m.className = id ? 'success' : ''; m.style.display = id ? 'block' : 'none'; setTimeout(()=>m.style.display='none',3000); };
    async function load() {
      try {
        const r = await fetch(API);
        const list = await r.json();
        const tbody = document.getElementById('employeeList');
        tbody.innerHTML = '';
        if(!Array.isArray(list) || list.length === 0){
          tbody.innerHTML = '<tr><td colspan="4" style="color:#888">No employees</td></tr>';
          return;
        }
        list.forEach(e => {
          const tr = document.createElement('tr');
          tr.innerHTML = `<td>${e.name||''}</td><td>${e.email||''}</td><td>${e.phone||''}</td>
            <td>
              <button data-id="${e.id}" class="btn-edit">Edit</button>
              <button data-id="${e.id}" class="btn-delete">Delete</button>
            </td>`;
          tbody.appendChild(tr);
        });
      } catch (err) { msg('Load failed: '+err.message); }
    }
    document.getElementById('employeeForm').addEventListener('submit', async (ev) => {
      ev.preventDefault();
      const id = document.getElementById('employeeId').value;
      const payload = { name: document.getElementById('name').value, email: document.getElementById('email').value, phone: document.getElementById('phone').value };
      try {
        const url = id ? `${API}/${id}` : API;
        const method = id ? 'PUT' : 'POST';
        const r = await fetch(url, { method, headers: {'Content-Type':'application/json'}, body: JSON.stringify(payload) });
        const text = await r.text();
        if (!r.ok) throw new Error(text || r.statusText);
        msg(text || (id ? 'Updated' : 'Saved'));
        document.getElementById('employeeForm').reset();
        document.getElementById('cancelBtn').style.display = 'none';
        await load();
      } catch (err) { msg('Save failed: '+err.message); }
    });
    document.getElementById('employeeList').addEventListener('click', async (ev) => {
      const id = ev.target.getAttribute('data-id');
      if (!id) return;
      if (ev.target.classList.contains('btn-delete')) {
        if (!confirm('Delete?')) return;
        try {
          const r = await fetch(`${API}/${id}`, { method: 'DELETE' });
          const text = await r.text();
          if (!r.ok) throw new Error(text || r.statusText);
          msg(text || 'Deleted');
          await load();
        } catch (err) { msg('Delete failed: '+err.message); }
      } else if (ev.target.classList.contains('btn-edit')) {
        const r = await fetch(API);
        const list = await r.json();
        const e = list.find(x => String(x.id) === String(id));
        if (e) {
          document.getElementById('employeeId').value = e.id;
          document.getElementById('name').value = e.name || '';
          document.getElementById('email').value = e.email || '';
          document.getElementById('phone').value = e.phone || '';
          document.getElementById('cancelBtn').style.display = 'inline';
        }
      }
    });
    document.getElementById('cancelBtn').addEventListener('click', () => {
      document.getElementById('employeeForm').reset();
      document.getElementById('employeeId').value = '';
      document.getElementById('cancelBtn').style.display = 'none';
    });
    load();
  </script>
</body>
</html>
